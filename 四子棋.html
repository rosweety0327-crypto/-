<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>經典四子棋</title>
    <style>
        body { background-color: #2c3e50; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; margin: 0; color: white; }
        #status { font-size: 24px; margin-bottom: 20px; }
        
        /* 棋盤容器 */
        #board {
            background-color: #3498db;
            padding: 10px;
            border-radius: 10px;
            display: grid;
            grid-template-columns: repeat(7, 60px);
            grid-template-rows: repeat(6, 60px);
            gap: 10px;
            border: 5px solid #2980b9;
        }

        /* 棋穴 */
        .slot {
            width: 60px;
            height: 60px;
            background-color: #ecf0f1;
            border-radius: 50%;
            cursor: pointer;
            position: relative;
        }

        /* 棋子樣式 */
        .player1 { background-color: #e74c3c !important; box-shadow: inset 0 0 10px rgba(0,0,0,0.3); } /* 紅棋 */
        .player2 { background-color: #f1c40f !important; box-shadow: inset 0 0 10px rgba(0,0,0,0.3); } /* 黃棋 */
        
        button { margin-top: 20px; padding: 10px 20px; font-size: 16px; cursor: pointer; background: #27ae60; color: white; border: none; border-radius: 5px; }
    </style>
</head>
<body>

    <div id="status">輪到：<span id="turn-text" style="color: #e74c3c;">紅棋 (玩家 1)</span></div>
    <div id="board"></div>
    <button onclick="resetGame()">重新開始</button>

<script>
    const ROWS = 6;
    const COLS = 7;
    let currentPlayer = 1; // 1 = 紅, 2 = 黃
    let gameActive = true;
    let board = []; // 0 = 空, 1 = 紅, 2 = 黃

    const boardEl = document.getElementById('board');
    const turnText = document.getElementById('turn-text');

    function createBoard() {
        boardEl.innerHTML = "";
        board = Array.from({ length: ROWS }, () => Array(COLS).fill(0));
        
        for (let r = 0; r < ROWS; r++) {
            for (let c = 0; c < COLS; c++) {
                const slot = document.createElement('div');
                slot.classList.add('slot');
                slot.dataset.row = r;
                slot.dataset.col = c;
                slot.onclick = () => dropPiece(c);
                boardEl.appendChild(slot);
            }
        }
    }

    function dropPiece(col) {
        if (!gameActive) return;

        // 從最底層開始找空格
        for (let r = ROWS - 1; r >= 0; r--) {
            if (board[r][col] === 0) {
                board[r][col] = currentPlayer;
                updateDisplay();
                
                if (checkWin(r, col)) {
                    gameActive = false;
                    alert(`遊戲結束！恭喜 ${currentPlayer === 1 ? '紅棋' : '黃棋'} 獲勝！`);
                    return;
                }

                if (board.every(row => row.every(cell => cell !== 0))) {
                    alert("平手！");
                    gameActive = false;
                    return;
                }

                currentPlayer = currentPlayer === 1 ? 2 : 1;
                turnText.innerText = currentPlayer === 1 ? "紅棋 (玩家 1)" : "黃棋 (玩家 2)";
                turnText.style.color = currentPlayer === 1 ? "#e74c3c" : "#f1c40f";
                return;
            }
        }
    }

    function updateDisplay() {
        const slots = document.querySelectorAll('.slot');
        slots.forEach((slot, index) => {
            const r = Math.floor(index / COLS);
            const c = index % COLS;
            slot.classList.remove('player1', 'player2');
            if (board[r][c] === 1) slot.classList.add('player1');
            if (board[r][c] === 2) slot.classList.add('player2');
        });
    }

    function checkWin(r, c) {
        const val = board[r][c];
        const directions = [
            [[0, 1], [0, -1]], // 水平
            [[1, 0], [-1, 0]], // 垂直
            [[1, 1], [-1, -1]], // 斜對角 \
            [[1, -1], [-1, 1]]  // 斜對角 /
        ];

        return directions.some(dir => {
            let count = 1;
            dir.forEach(([dr, dc]) => {
                let currR = r + dr;
                let currC = c + dc;
                while (currR >= 0 && currR < ROWS && currC >= 0 && currC < COLS && board[currR][currC] === val) {
                    count++;
                    currR += dr;
                    currC += dc;
                }
            });
            return count >= 4;
        });
    }

    function resetGame() {
        currentPlayer = 1;
        gameActive = true;
        turnText.innerText = "紅棋 (玩家 1)";
        turnText.style.color = "#e74c3c";
        createBoard();
    }

    createBoard();
</script>
</body>
</html>