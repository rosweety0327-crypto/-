<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>3äººç‹¼äººæ®ºï¼šæš´åŠ›é–‹å§‹ç‰ˆ</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        body { background: #000; color: #fff; font-family: sans-serif; text-align: center; padding: 20px; }
        
        /* æš´åŠ›æŒ‰éˆ•ï¼šé€™é¡†æŒ‰éˆ•çµ•å°ä¸æœƒä¸è¦‹ */
        #force-start-btn { 
            background: #ff0000; 
            color: white; 
            padding: 30px; 
            font-size: 30px; 
            font-weight: bold; 
            border: 5px solid white;
            border-radius: 20px;
            cursor: pointer;
            width: 90%;
            max-width: 400px;
            margin: 20px auto;
            display: block !important; /* å¼·åˆ¶é¡¯ç¤º */
            box-shadow: 0 0 30px rgba(255,0,0,0.8);
        }

        #log { width: 90%; height: 150px; background: #222; margin: 10px auto; overflow-y: auto; padding: 10px; color: #0f0; border-radius: 10px; }
        .setup-info { background: #1a1a1a; padding: 15px; border-radius: 10px; margin-bottom: 20px; border: 1px solid #444; }
        #board { display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 10px; padding: 20px; }
        .card { background: #333; padding: 15px; border-radius: 10px; border: 2px solid #555; }
    </style>
</head>
<body>

    <h1 style="color: #ff00ff;">ğŸ’€ ç‹¼äººæ®ºï¼šå¼·åˆ¶é–‹æˆ° ğŸ’€</h1>

    <button id="force-start-btn" onclick="startGame()">âš”ï¸ ç«‹åˆ»é–‹å§‹éŠæˆ²</button>

    <div class="setup-info">
        <p>ä½ çš„é€£ç·š ID: <b id="my-id" style="color:#f1c40f">---</b></p>
        <label>è¨­å®šäººæ•¸ (3-23): </label>
        <input type="number" id="total-players" value="6" min="3" max="23" style="font-size:20px; width:60px;">
    </div>

    <div id="log">ã€ç³»çµ±æç¤ºã€‘å¦‚æœçœ‹ä¸åˆ°æŒ‰éˆ•ï¼Œè«‹é‡æ–°æ•´ç†ç¶²é ã€‚<br>é€£ç·š ID è·‘å‡ºä¾†å¾Œå¯ä»¥åˆ†çµ¦å°å¸Œå§Šå§Šã€‚</div>

    <div id="board"></div>

    <script>
        let peer = new Peer();
        let myId, connections = [], isHost = true, gameStarted = false;

        peer.on('open', id => {
            myId = id;
            document.getElementById('my-id').innerText = id;
        });

        peer.on('connection', conn => {
            connections.push(conn);
            document.getElementById('log').innerHTML += `<br>æ–°ç©å®¶åŠ å…¥ï¼ç›®å‰é€£ç·šï¼š${connections.length}`;
        });

        function startGame() {
            if (gameStarted) return;
            gameStarted = true;
            
            const total = parseInt(document.getElementById('total-players').value);
            const board = document.getElementById('board');
            const log = document.getElementById('log');
            
            // éš±è—è¨­å®šå€å’ŒæŒ‰éˆ•
            document.getElementById('force-start-btn').style.display = 'none';
            document.querySelector('.setup-info').style.display = 'none';
            
            log.innerHTML = "â˜… éŠæˆ²æ­£å¼å•Ÿå‹•ï¼é»‘æš—é™è‡¨ â˜…";
            board.innerHTML = "";

            // ç”¢å‡ºç©å®¶
            for(let i=0; i < total; i++) {
                let name = (i === 0) ? "å°å®¥é ˜ä¸»" : (i <= connections.length ? "ç©å®¶ "+(i+1) : "AI è²“å¥´ "+(i+1));
                let role = (i === 0) ? "é è¨€å®¶" : (i === 1 ? "ç‹¼äºº" : "å¹³æ°‘");
                
                const div = document.createElement('div');
                div.className = 'card';
                div.innerHTML = `<b>${name}</b><br><br>èº«åˆ†ï¼š${role}`;
                board.appendChild(div);
            }
        }
    </script>
</body>
</html>
